<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="SwitchMyPlan - Compare and switch to the best mobile plans in Canada. Switch, Save, Smile!">
<title>SwitchMyPlan | Switch, Save, Smile! | Mobile Plan Comparison</title>

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%230066FF' d='M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-1-11v6h2v-6h-2zm0-4v2h2V7h-2z'/%3E%3C/svg%3E">

<!-- Stylesheets -->
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300..900&family=Space+Grotesk:wght@300..700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/splitting/dist/splitting.css" />
<link rel="stylesheet" href="https://unpkg.com/locomotive-scroll/dist/locomotive-scroll.css" />

<!-- Apple Garamond Font -->
<style>
@font-face {
  font-family: 'Apple Garamond';
  src: url('https://db.onlinewebfonts.com/t/5c00984bd31d7510b4e89bc1aafcf755.eot');
  src: url('https://db.onlinewebfonts.com/t/5c00984bd31d7510b4e89bc1aafcf755.eot?#iefix') format('embedded-opentype'),
       url('https://db.onlinewebfonts.com/t/5c00984bd31d7510b4e89bc1aafcf755.woff2') format('woff2'),
       url('https://db.onlinewebfonts.com/t/5c00984bd31d7510b4e89bc1aafcf755.woff') format('woff'),
       url('https://db.onlinewebfonts.com/t/5c00984bd31d7510b4e89bc1aafcf755.ttf') format('truetype'),
       url('https://db.onlinewebfonts.com/t/5c00984bd31d7510b4e89bc1aafcf755.svg#Apple Garamond') format('svg');
}
</style>

<script>
  tailwind.config = {
    theme: {
      extend: {
        colors: {
          accent: '#4470FF',
          tertiary: '#7C4DFF',
        },
        fontFamily: {
          sans: ['Outfit', 'system-ui', 'sans-serif'],
          display: ['Space Grotesk', 'system-ui', 'sans-serif'],
        },
      },
    },
  }
</script>

<style>
:root {
  --color-bg: #bfcffa;
  --color-text: #2a3158;
  --color-text-light: #5a6184;
  --color-accent: #4470FF;
  --color-tertiary: #7C4DFF;
  --color-surface: #ffffff;
  --color-surface-hover: #f5f7ff;
  --ease-out: cubic-bezier(0.33, 1, 0.68, 1);
  --ease-in: cubic-bezier(0.63, 0.03, 0.33, 0.8);
  --ease-elastic: cubic-bezier(0.65, 0, 0.35, 1.5);
  --accent-rgb: 68, 112, 255;
}

html {
  scroll-behavior: smooth;
}

body {
  font-family: 'Outfit', system-ui, sans-serif;
  -webkit-font-smoothing: antialiased;
  background: linear-gradient(135deg, #bfcffa 0%, #e8f0ff 100%);
  color: #2a3158;
  cursor: default;
  overflow-x: hidden;
}

/* Full-width section styles */
.page-section {
  width: 100%;
  position: relative;
  overflow: hidden;
}

.page-section.bg-white {
  background-color: rgba(218, 228, 255, 0.9);
}

.page-section.bg-gradient {
  background: linear-gradient(135deg, #bfcffa 0%, #e8f0ff 100%);
}

.font-display {
  font-family: 'Space Grotesk', system-ui, sans-serif;
  font-weight: 600;
  letter-spacing: -0.02em;
}

.noise-bg {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;
  opacity: 0.04;
  pointer-events: none;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
}

/* Scrollbar */
::-webkit-scrollbar {
  width: 5px;
}
::-webkit-scrollbar-track {
  background: var(--color-bg);
}
::-webkit-scrollbar-thumb {
  background: var(--color-accent);
}

/* Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

@keyframes glow {
  0%, 100% { filter: brightness(1); }
  50% { filter: brightness(1.2); }
}

@keyframes rotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

@keyframes keep-upright {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(-360deg); }
}

@keyframes shrink-in {
  0% { transform: scale(1.1); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}

@keyframes slide-up {
  0% { transform: translateY(20px); opacity: 0; }
  100% { transform: translateY(0); opacity: 1; }
}

@keyframes slide-left {
  0% { transform: translateX(20px); opacity: 0; }
  100% { transform: translateX(0); opacity: 1; }
}

@keyframes slide-right {
  0% { transform: translateX(-20px); opacity: 0; }
  100% { transform: translateX(0); opacity: 1; }
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

.animate-pulse-slow {
  animation: pulse 4s var(--ease) infinite;
}

.animate-glow {
  animation: glow 3s var(--ease) infinite;
}

.animate-spin-slow {
  animation: rotate 15s linear infinite;
}

.animate-shrink-in {
  animation: shrink-in 0.8s var(--ease-out) forwards;
}

.animate-slide-up {
  animation: slide-up 0.8s var(--ease-out) forwards;
}

.animate-slide-left {
  animation: slide-left 0.8s var(--ease-out) forwards;
}

.animate-slide-right {
  animation: slide-right 0.8s var(--ease-out) forwards;
}

/* Cursor effects */
.custom-cursor {
  position: fixed;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background-color: var(--color-accent);
  pointer-events: none;
  mix-blend-mode: exclusion;
  transform: translate(-50%, -50%);
  z-index: 9999;
  transition: width 0.3s, height 0.3s, background-color 0.3s;
}

.cursor-text {
  position: fixed;
  background-color: var(--color-accent);
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  transform: translate(-50%, -50%);
  pointer-events: none;
  z-index: 9999;
  font-size: 12px;
  white-space: nowrap;
}

/* Magnetic buttons */
.magnetic-btn {
  position: relative;
  border-radius: 9999px;
  z-index: 1;
  transition: transform 0.3s var(--ease);
  overflow: hidden;
}

.magnetic-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, var(--color-accent), var(--color-tertiary));
  border-radius: inherit;
  z-index: -1;
  opacity: 0;
  transition: opacity 0.3s var(--ease);
}

.magnetic-btn:hover::before {
  opacity: 1;
}

/* Gradient text */
.gradient-text {
  background: linear-gradient(90deg, #4470ff 0%, #7C4DFF 100%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}

/* Orbit effect */
.orbit-container {
  position: relative;
}

.orbit {
  position: absolute;
  border-radius: 50%;
  border: 1px solid rgba(255, 255, 255, 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  animation: rotate 20s linear infinite;
}

.orbit-item {
  position: absolute;
  transform-origin: center;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.5s var(--ease-out);
}

.orbit-item img {
  border-radius: 50%;
  transition: all 0.3s var(--ease);
}

.orbit-item:hover img {
  transform: scale(1.3);
  box-shadow: 0 0 30px rgba(0, 102, 255, 0.3);
}

/* Hero section 3D effect */
.hero-card {
  transform-style: preserve-3d;
  perspective: 1000px;
}

.hero-card-inner {
  position: relative;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
  transition: transform 0.6s var(--ease-out);
}

.hero-tilt-element {
  transform-style: preserve-3d;
  transform: translateZ(20px);
}

/* Carrier cards */
.carrier-card {
  position: relative;
  overflow: hidden;
  border-radius: 1rem;
  backdrop-filter: blur(10px);
  background: rgba(255, 255, 255, 0.7);
  border: 1px solid rgba(255, 255, 255, 0.8);
  transition: all 0.5s var(--ease-out);
}

.carrier-card::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(
    135deg,
    rgba(255, 255, 255, 0.1) 0%,
    rgba(255, 255, 255, 0.05) 50%,
    rgba(255, 255, 255, 0) 100%
  );
  z-index: -1;
}

.carrier-card::after {
  content: '';
  position: absolute;
  width: 200%;
  height: 200%;
  top: -50%;
  left: -50%;
  background: radial-gradient(circle at center, rgba(255, 255, 255, 0.1) 0%, transparent 20%);
  opacity: 0;
  transition: opacity 0.7s var(--ease-out);
  z-index: -1;
}

.carrier-card:hover::after {
  opacity: 1;
}

.carrier-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
  border-color: rgba(255, 255, 255, 0.2);
}

/* Marquee animation */
.marquee {
  position: relative;
  width: 100%;
  overflow: hidden;
}

.marquee-content {
  display: flex;
  animation: marquee 20s linear infinite;
}

.marquee-content-reversed {
  animation-direction: reverse;
}

@keyframes marquee {
  0% { transform: translateX(0); }
  100% { transform: translateX(-50%); }
}

/* Reveal animations */
.reveal-fade {
  opacity: 0;
  transition: opacity 0.6s var(--ease-out);
}

.reveal-slide-up {
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s var(--ease-out), transform 0.6s var(--ease-out);
}

.reveal-slide-left {
  opacity: 0;
  transform: translateX(30px);
  transition: opacity 0.6s var(--ease-out), transform 0.6s var(--ease-out);
}

.reveal-slide-right {
  opacity: 0;
  transform: translateX(-30px);
  transition: opacity 0.6s var(--ease-out), transform 0.6s var(--ease-out);
}

.reveal-scale {
  opacity: 0;
  transform: scale(0.9);
  transition: opacity 0.6s var(--ease-out), transform 0.6s var(--ease-out);
}

.reveal-rotate {
  opacity: 0;
  transform: rotate(5deg);
  transition: opacity 0.6s var(--ease-out), transform 0.6s var(--ease-out);
}

.is-revealed {
  opacity: 1;
  transform: translate(0) scale(1) rotate(0);
}

/* Plan cards */
.plan-card {
  position: relative;
  flex-shrink: 0;
  width: 100%;
  min-height: 520px;
  border-radius: 24px;
  overflow: hidden;
  background: linear-gradient(to bottom, rgba(210, 210, 210, 0.9), rgba(230, 240, 255, 0.9));
  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  transition: all 0.3s var(--ease);
  border: none;
  max-width: 468px; /* Increased from 390px by 20% */
  margin: 0 auto;
}

.plan-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 25px 30px -12px rgba(68, 112, 255, 0.25);
}

/* Gradient border animation on hover - ENHANCED */
.plan-card::after {
  content: '';
  position: absolute;
  inset: -2px; /* Slightly bigger to create outer glow effect */
  border-radius: 1.5rem;
  padding: 4px; /* Thicker border */
  background: linear-gradient(
    90deg,
    #4470FF,
    #7C4DFF,
    #FF4D94,
    #4470FF
  );
  background-size: 300% 300%;
  -webkit-mask: 
    linear-gradient(#fff 0 0) content-box, 
    linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  opacity: 0;
  transition: opacity 0.3s ease;
  box-shadow: 0 0 15px rgba(68, 112, 255, 0.6);
  filter: blur(2px);
  z-index: 4;
}

.plan-card:hover::after {
  opacity: 1;
  animation: gradient-border 3s linear infinite;
}

/* Add glow effect on hover */
.plan-card:hover {
  filter: drop-shadow(0 0 15px rgba(68, 112, 255, 0.6));
}

/* Additional outer glow border for plan cards */
.plan-card::before {
  content: '';
  position: absolute;
  inset: -3px;
  border-radius: 1.8rem;
  background: linear-gradient(
    45deg,
    #4470FF,
    #7C4DFF,
    #FF4D94,
    #4470FF
  );
  background-size: 400% 400%;
  opacity: 0;
  z-index: 3;
  transition: opacity 0.4s ease;
  filter: blur(8px);
}

.plan-card:hover::before {
  opacity: 0.8;
  animation: gradient-border 4s linear infinite;
}

@keyframes gradient-border {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

/* Enhance card content on hover */
.plan-card > div {
  transition: transform 0.3s ease, opacity 0.3s ease;
}

.plan-card:hover > div {
  transform: translateZ(10px);
  opacity: 1;
}

/* Card header section */
.plan-card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1.5rem 1.5rem 0.75rem;
}

/* Plan name section */
.plan-card-name {
  min-height: 75px;
  padding: 0 1.5rem 0.5rem;
}

.plan-card-name .text-2xl {
  font-size: 1.8rem; /* Increased from 1.5rem by 20% */
  line-height: 1.3;
}

.plan-card-name .text-gray-500 {
  font-size: 0.9rem; /* Increased from 0.75rem by 20% */
}

/* Features section */
.plan-card-features {
  flex: 1;
  padding: 1rem 1.5rem;
  overflow-y: auto;
  max-height: 290px; /* Increased from 270px */
  background: rgba(211, 228, 250, 0.15);
  scrollbar-width: thin;
  scrollbar-color: rgba(68, 112, 255, 0.3) transparent;
  border: none;
}

/* Restore scrollbar styling */
.plan-card-features::-webkit-scrollbar {
  width: 6px;
}

.plan-card-features::-webkit-scrollbar-track {
  background: transparent;
}

.plan-card-features::-webkit-scrollbar-thumb {
  background-color: rgba(68, 112, 255, 0.3);
  border-radius: 3px;
}

/* Footer section */
.plan-card-footer {
  display: flex;
  flex-direction: column;
  padding: 0.75rem 1.5rem 1.5rem;
  background: transparent;
  border-top: none;
}

.plan-card-footer .text-xs {
  font-size: 0.8rem;
  margin-bottom: 0.75rem;
}

/* Select plan button */
.select-plan-button {
  background: linear-gradient(135deg, var(--color-accent), var(--color-tertiary));
  color: white !important;
  font-weight: 500;
  padding: 0.9rem 1.5rem;
  border-radius: 9999px;
  text-align: center;
  transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  position: relative;
  overflow: hidden;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  box-shadow: 0 8px 20px rgba(68, 112, 255, 0.3);
  font-size: 1rem;
  margin-top: 0.5rem;
}

.select-plan-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(68, 112, 255, 0.35);
}

.select-plan-button::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0) 100%);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.select-plan-button:hover::before {
  opacity: 1;
}

.plan-card .carrier-logo {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  height: 65px;
  width: auto;
  max-width: 115px;
  transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  margin-bottom: 0;
}

.plan-card .carrier-logo img {
  height: 100%;
  width: auto;
  max-width: 115px;
  object-fit: contain;
  filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
  transition: all 0.3s ease;
  animation: none !important;
}

/* Additional space specifically for Virgin and Koodo carrier logos */
.plan-card[data-carrier="Virgin"] .carrier-logo,
.plan-card[data-carrier="Koodo"] .carrier-logo {
  height: 90px; /* Increased from 80px for the even larger logos */
  padding-top: 8px;
  padding-bottom: 8px;
}

/* Price styling */
.price-text {
  font-size: 2.8rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--color-accent), var(--color-tertiary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  font-family: 'Space Grotesk', sans-serif;
  line-height: 1;
}

.price-suffix {
  font-size: 1.2rem; /* Increased from 1rem by 20% */
  color: #64748b;
  margin-left: 0.25rem;
  -webkit-text-fill-color: #64748b;
}

/* Feature item styling */
.feature-item {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.5rem 0.7rem;
  margin-bottom: 0.25rem;
  transition: all 0.2s ease;
}

.feature-item:hover {
  background: rgba(68, 112, 255, 0.08);
}

.feature-icon {
  width: 1.5rem;
  height: 1.5rem;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  background: rgba(68, 112, 255, 0.1);
  color: var(--color-accent);
}

.feature-text {
  font-size: 1.05rem; /* Increased from 0.875rem by 20% */
  color: #334155;
  line-height: 1.5;
}

/* Specific adjustments for Virgin and Koodo logos */
.plan-card[data-carrier="Virgin"] .carrier-logo img {
  transform: scale(2.24) !important;
  max-width: none !important;
}

.plan-card[data-carrier="Koodo"] .carrier-logo img {
  transform: scale(3.71) !important;
  max-width: none !important;
}

@media (max-width: 768px) {
  #planCarousel > div, #prepaidCarousel > div {
    min-width: 100%;
  }
  
  .plan-card {
    min-height: 580px; /* Increased from 520px to match the desktop height adjustment */
  }
}

.carrier-logo-gradient {
  position: absolute;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  opacity: 0.7;
  filter: blur(10px);
  z-index: -1;
  transition: all 0.3s var(--ease);
}

/* Mobile optimizations */
@media (max-width: 768px) {
  .carrier-logo-gradient {
    opacity: 0.4;
    filter: blur(5px);
  }
  
  .plan-card {
    border-radius: 1.2rem;
  }
}

/* Carrier logo styles for free-floating logos */
.carrier-logo {
  transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
}

.carrier-logo::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 80%;
  height: 80%;
  transform: translate(-50%, -50%);
  border-radius: 9999px;
  background: radial-gradient(rgba(255,255,255,0.7) 0%, rgba(255,255,255,0) 70%);
  opacity: 0;
  transition: opacity 0.3s ease;
  z-index: -1;
}

.carrier-logo:hover {
  transform: scale(1.1) translateY(-5px);
}

.carrier-logo:hover::after {
  opacity: 0.8;
}

.carrier-logo img {
  filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.1));
  transition: all 0.3s ease;
  max-width: 100%;
  height: auto;
}

/* Keep logos upright while orbiting */
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

@keyframes keep-upright {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(-360deg); }
}

.carrier-orbit {
  animation: none;
}

.carrier-logo {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 1rem;
  transition: transform 0.2s ease;
}

.carrier-logo:hover {
  transform: scale(1.05);
}

  .carrier-logo img {
  max-height: 3.5rem;
  object-fit: contain;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.05));
  animation: none;
  background-color: transparent;
  padding: 0;
  border-radius: 0;
  box-shadow: none;
  transform: scale(1.2); /* Make all logos 20% bigger */
}

/* Specific adjustments for Virgin and Koodo logos */
.carrier-logo img[alt="Virgin"] {
  transform: scale(1.5) !important;
  max-width: none !important;
}

.carrier-logo img[alt="Koodo"] {
  transform: scale(2.25) !important; /* Increase Koodo logo size by 50% more */
  max-width: none !important;
}

/* Button and card styles for light theme */
.bg-accent {
  background-color: var(--color-accent);
}

.text-accent {
  color: var(--color-accent);
}

.card-hover, .plan-card {
  background: rgba(255, 255, 255);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(88, 46, 255, 0.8);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.05);
}

/* Update text colors for better contrast on light background */
.text-white {
  color: var(--color-text);
}

.text-white\/70 {
  color: var(--color-text-light);
}

.text-white\/60 {
  color: rgba(255, 255, 255, 0.6);
}

.text-white\/40 {
  color: rgba(255, 255, 255, 0.4);
}



/* Plan carousel styles */
.plan-carousel-container {
  position: relative;
  width: 100%;
  overflow-x: hidden;
  padding: 0 1.5rem; /* Reduced from 2rem */
}

#planCarousel, #prepaidCarousel {
  display: flex;
  gap: 0.5rem; /* Reduced from 1rem */
  transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  padding: 10px;
}

#planCarousel > div, #prepaidCarousel > div {
  min-width: calc(33.333% - 0.667rem);
}

/* Media queries for responsive carousel display */
@media (max-width: 1024px) and (min-width: 769px) {
  #planCarousel > div, #prepaidCarousel > div {
    min-width: calc(50% - 0.5rem); /* Show 2 cards on medium screens */
  }
}

@media (max-width: 768px) {
  #planCarousel > div, #prepaidCarousel > div {
    min-width: 100%; /* Show 1 card on small screens */
  }
  
  .plan-card {
    min-height: 580px; /* Increased from 520px to match the desktop height adjustment */
  }
}

/* Plan card hover effects */
.plan-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 5px;
  background: linear-gradient(90deg, var(--color-accent), var(--color-tertiary));
  z-index: 1;
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 0.6s var(--ease-out);
}

.plan-card:hover::before {
  transform: scaleX(1);
}

.plan-card::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: radial-gradient(
    circle at 50% 0%, 
    rgba(0, 102, 255, 0.15) 0%,
    transparent 70%
  );
  opacity: 0;
  transition: opacity 0.6s var(--ease);
  z-index: 0;
  pointer-events: none;
}

.plan-card:hover::after {
  opacity: 1;
}

/* Add subtle gradient transitions between sections */
.plan-card > div {
  position: relative;
  z-index: 1;
}

.plan-card > div::after {
  content: '';
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  height: 8px;
  background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, 0.1));
  pointer-events: none;
}

.plan-card > div:last-child::after {
  display: none;
}

/* End of carousel styles */

/* Add these styles to match the all-plans.html header */
/* Navigation styles */
#navbar {
            background: linear-gradient(135deg, #f0f4ff, #d2e0f9);
  transition: all 0.3s var(--ease-out);
}

#navbar.scrolled {
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
            background: linear-gradient(135deg, #f0f4ff 0%, #d2e0f9 100%);
}

.nav-link {
  position: relative;
  padding: 0.5rem 1rem;
  transition: color 0.3s var(--ease);
}

.nav-link::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 2px;
  background: linear-gradient(90deg, var(--color-accent), var(--color-tertiary));
  transform: scaleX(0);
  transform-origin: right;
  transition: transform 0.3s var(--ease-out);
}

.nav-link:hover::after {
  transform: scaleX(1);
  transform-origin: left;
}

.nav-link:hover {
  color: var(--color-accent);
}

/* Mobile menu styles */
.mobile-menu-button {
  display: none;
  padding: 0.5rem;
  border-radius: 0.5rem;
  transition: background-color 0.3s var(--ease);
}

@media (max-width: 768px) {
  .mobile-menu-button {
    display: block;
  }

  #mobile-menu {
    transition: opacity 0.3s var(--ease), visibility 0.3s var(--ease);
    visibility: hidden;
    opacity: 0;
    display: flex !important;
  }

  #mobile-menu.active {
    visibility: visible;
    opacity: 1;
  }

  #mobile-menu a {
    transform: translateY(20px);
    opacity: 0;
    transition: transform 0.4s var(--ease), opacity 0.4s var(--ease);
  }

  #mobile-menu.active a {
    transform: translateY(0);
    opacity: 1;
  }

  #mobile-menu.active a:nth-child(1) { transition-delay: 0.1s; }
  #mobile-menu.active a:nth-child(2) { transition-delay: 0.15s; }
  #mobile-menu.active a:nth-child(3) { transition-delay: 0.2s; }
  #mobile-menu.active a:nth-child(4) { transition-delay: 0.25s; }

  .nav-link {
    display: block;
    padding: 0.75rem 1rem;
    border-radius: 0.5rem;
  }

  .nav-link:hover {
    background: rgba(var(--accent-rgb), 0.1);
  }
}

/* Select plan button */
.select-plan-button {
    background: linear-gradient(135deg, var(--color-accent), var(--color-tertiary));
    color: white !important;
    font-weight: 500;
    padding: 0.9rem 1.5rem;
    border-radius: 9999px;
    text-align: center;
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    position: relative;
    overflow: hidden;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    box-shadow: 0 8px 20px rgba(68, 112, 255, 0.3);
    font-size: 1rem;
    margin-top: 0.5rem;
}

.select-plan-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(68, 112, 255, 0.35);
}

.select-plan-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0) 100%);
    opacity: 0;
    transition: opacity 0.3s ease;
}

.select-plan-button:hover::before {
    opacity: 1;
}

/* Carousel navigation buttons */
.carousel-button {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  width: 3.5rem;
  height: 3.5rem;
  border-radius: 9999px;
  background: white;
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s;
  z-index: 20;
  border: 1px solid rgba(0, 0, 0, 0.05);
}

.carousel-button:hover {
  background: #f9fafb;
  box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
  transform: translateY(-50%) scale(1.05);
}

.carousel-button.prev {
  left: -1rem;
}

.carousel-button.next {
  right: -1rem;
}

.carousel-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: translateY(-50%) scale(1);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
}

/* Carousel container styles */
.plan-carousel-container {
  position: relative;
  width: 100%;
  overflow: hidden;
  padding: 0 1.5rem; /* Reduced from 2rem */
}

#planCarousel, #prepaidCarousel {
  display: flex;
  gap: 0.5rem; /* Reduced from 1rem */
  transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  padding: 10px;
}

#planCarousel > div, #prepaidCarousel > div {
  min-width: calc(33.333% - 0.667rem);
}

/* Media queries for responsive carousel display */
@media (max-width: 1024px) and (min-width: 769px) {
  #planCarousel > div, #prepaidCarousel > div {
    min-width: calc(50% - 0.5rem); /* Show 2 cards on medium screens */
  }
}

@media (max-width: 768px) {
  #planCarousel > div, #prepaidCarousel > div {
    min-width: 100%; /* Show 1 card on small screens */
  }
  
  .plan-card {
    min-height: 580px; /* Increased from 520px to match the desktop height adjustment */
  }
}

/* Carrier logo styles */
.carrier-logo {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 1rem;
  transition: transform 0.2s ease;
}

.carrier-logo:hover {
  transform: scale(1.05);
}

.carrier-logo img {
  max-height: 3.5rem;
  object-fit: contain;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.05));
  animation: none;
  background-color: transparent;
  padding: 0;
  border-radius: 0;
  box-shadow: none;
  transform: scale(1.2); /* Make all logos 20% bigger */
}

/* Specific adjustments for Virgin and Koodo logos in the hero section */
a.carrier-logo img[alt="Virgin"] {
  transform: scale(1.5) !important;
  max-width: none !important;
}

a.carrier-logo img[alt="Koodo"] {
  transform: scale(2.25) !important; /* Increase Koodo logo size by 50% more */
  max-width: none !important;
}

/* Plan card specific styles */
.plan-card[data-carrier="Virgin"] .carrier-logo img {
  transform: scale(2.24) !important; /* Increased from 1.95 by 15% more */
  max-width: none !important;
}

.plan-card[data-carrier="Koodo"] .carrier-logo img {
  transform: scale(3.71) !important; /* Increased from 2.85 by 30% more */
  max-width: none !important;
}

/* Remove keep-upright animations */
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Chat animation */
@keyframes dotsAnimation {
  0%, 20% { content: '.'; }
  40% { content: '..'; }
  60%, 100% { content: '...'; }
}

.dots::after {
  content: '';
  animation: dotsAnimation 1.5s infinite linear;
}

@media (max-width: 640px) {
  .plan-card {
    min-height: 520px;
  }
  
  .carousel-button {
    width: 3rem;
    height: 3rem;
  }
  
  .carousel-button.prev {
    left: -0.5rem;
  }
  
  .carousel-button.next {
    right: -0.5rem;
  }
}

/* Shine effect for plan cards on hover */
.plan-card .shine {
  content: '';
  position: absolute;
  top: -50%;
  left: -100%;
  width: 60%;
  height: 200%;
  background: linear-gradient(
    90deg,
    transparent,
    rgba(255, 255, 255, 0.96),
    transparent
  );
  transform: rotate(30deg);
  transition: left 0.5s ease;
  z-index: 5;
  pointer-events: none;
}

.plan-card:hover .shine {
  left: 150%;
  transition: left 0.7s ease-in-out;
}

.carousel-wrapper {
  width: 100%;
  overflow: hidden;
  position: relative;
}

.carousel-container {
  display: flex;
  transition: transform 0.5s ease;
}

.plan-card {
  flex: 0 0 calc(100% / 3 - 20px);
  margin: 0 10px;
  background-color: rgb(215, 233, 254);
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  transition: all 0.3s ease;
}

/* Responsive card sizes */
@media (max-width: 1023px) {
  .plan-card {
    flex: 0 0 calc(50% - 20px);
  }
}

@media (max-width: 767px) {
  .plan-card {
    flex: 0 0 calc(100% - 20px);
  }
}

.plan-card:hover {
  box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
  transform: translateY(-5px);
}

.carousel-nav {
  display: flex;
  justify-content: center;
  margin-top: 20px;
  gap: 10px;
}

.carousel-nav button {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background-color: var(--accent-color);
  color: white;
  border: none;
  font-size: 18px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
}

.carousel-nav button:disabled {
  background-color: #ccc;
  cursor: not-allowed;
}

.carousel-nav button:not(:disabled):hover {
  background-color: var(--accent-dark);
  transform: scale(1.1);
}

.no-plans-message {
  text-align: center;
  padding: 40px;
  color: #666;
  font-size: 18px;
}

/* Ensure plan cards take the full height */
.plan-card {
  display: flex;
  flex-direction: column;
  min-height: 580px;
  height: 580px; /* Fixed height for consistency */
  overflow: hidden; /* Ensure content doesn't overflow */
}

/* Makes sure carrier logo section is well-sized */
.plan-card .carrier-logo {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  height: 75px;
  width: auto;
  max-width: 120px;
  transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  margin-bottom: 5px;
}

/* Proper layout for card header */
.plan-card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

/* Fix features section to grow properly and restore scrolling */
.plan-card-features {
  flex: 1;
  padding: 1rem 1.5rem;
  overflow-y: auto;
  max-height: 290px; /* Increased from 270px */
  background: rgba(211, 228, 250, 0.15);
  scrollbar-width: thin;
  scrollbar-color: rgba(68, 112, 255, 0.3) transparent;
  border: none;
}

/* Restore scrollbar styling */
.plan-card-features::-webkit-scrollbar {
  width: 6px;
}

.plan-card-features::-webkit-scrollbar-track {
  background: transparent;
}

.plan-card-features::-webkit-scrollbar-thumb {
  background-color: rgba(68, 112, 255, 0.3);
  border-radius: 3px;
}

/* Footer section */
.plan-card-footer {
  display: flex;
  flex-direction: column;
  padding: 0.75rem 1.5rem 1.5rem;
  background: transparent;
  border-top: none;
}

.plan-card-footer .text-xs {
  font-size: 0.8rem;
  margin-bottom: 0.75rem;
}

/* Make carousel container properly sized */
.plan-carousel-container {
  position: relative;
  width: 100%;
  overflow: visible;
  padding: 0 1.5rem; /* Reduced from 2rem */
  margin: 1rem 0;
}

.ribbon-container {
  position: relative;
  overflow: hidden;
}

.ribbon {
  position: absolute;
  top: 25px;
  right: -30px;
  transform: rotate(45deg);
  background: linear-gradient(135deg, #ff6b6b, #ff4757);
  color: white;
  padding: 7px 40px;
  font-size: 0.8rem;
  font-weight: 600;
  text-transform: uppercase;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  z-index: 2;
  text-align: center;
  letter-spacing: 1px;
}
</style>

<!-- Update carousel HTML structure -->

</head>
<body class="min-h-screen overflow-x-hidden">
  <!-- Background noise -->
  <div class="noise-bg"></div>

  <!-- Navigation -->
  <nav id="navbar" class="fixed top-0 left-0 right-0 z-50 py-5 transition-all">
    <div class="container mx-auto px-6 flex justify-center">
      <div class="flex items-center justify-between w-full">
        <!-- Logo -->
        <a href="/" class="text-4xl font-['Apple_Garamond'] font-semibold" style="font-size: 3.5rem;">
          <span class="text-black">Swicth</span><span class="gradient-text">My</span><span class="text-black">Plan</span>
        </a>

        <!-- Mobile menu button -->
        <button class="mobile-menu-button md:hidden" aria-label="Toggle menu">
          <i class="ri-menu-line text-2xl"></i>
        </button>

        <!-- Desktop menu -->
        <div class="desktop-menu hidden md:flex items-center gap-8 justify-center">
          <a href="all-plans.html" class="nav-link">Plans</a>
          <a href="faq.html" class="nav-link">FAQ</a>
          <a href="about.html" class="nav-link">About</a>
    </div>

        <!-- CTA buttons -->
        <div class="hidden md:flex items-center gap-4">
          <a href="all-plans.html" class="magnetic-btn py-4 px-8 rounded-full bg-accent hover:bg-accent/90 text-white font-medium shadow-lg shadow-accent/25 transition-all flex items-center gap-2">
                <span>Compare Plans</span>
                
              </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
    <section class="min-h-screen relative flex items-center w-full page-section bg-gradient" id="hero">
      <!-- Background gradient effects -->
      <div class="absolute inset-0" style="z-index: 1;">
        <div class="absolute top-[-20%] right-[-10%] w-[60%] h-[70%] rounded-full blur-[120px] bg-blue-300/30 animate-pulse-slow"></div>
        <div class="absolute bottom-[-10%] left-[-5%] w-[50%] h-[60%] rounded-full blur-[120px] bg-indigo-300/30 animate-pulse-slow" style="animation-delay: -2s"></div>
        </div>

      <!-- Floating particles - updated for light theme -->
      <div class="particles-container absolute inset-0 opacity-30" style="z-index: 2;"></div>
      
      <div class="container mx-auto px-6 pt-32" style="z-index: 3;">
        <div class="grid lg:grid-cols-2 gap-16 items-center">
          <div class="max-w-xl">
            <!-- Animated welcome text -->
            <div class="overflow-hidden mb-5">
              <span class="inline-block text-accent/90 font-medium uppercase tracking-wider text-xl animate-slide-up" style="animation-delay: 0.1s">
                Mobile plans reimagined
              </span>
            </div>

            <!-- Main headline -->
            <div class="overflow-hidden mb-4">
              <h1 class="font-display text-4xl md:text-5xl lg:text-6xl font-bold leading-tight animate-slide-up text-[#2a3158]" style="animation-delay: 0.2s">
                <span>Find Your</span>
                <span class="relative inline-block">
                  <span class="gradient-text">Perfect</span>
                  <svg class="absolute -bottom-3 left-0 w-full" viewBox="0 0 400 44" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2 30.4917C45.0045 15.4002 148.009 -13.2319 195 30.4917C242.068 74.3086 344.019 42.6234 398 30.4917" stroke="url(#paint0_linear_102_83)" stroke-width="4" stroke-linecap="round"/>
                    <defs>
                      <linearGradient id="paint0_linear_102_83" x1="2" y1="32" x2="398" y2="32" gradientUnits="userSpaceOnUse">
                        <stop stop-color="#4470FF"/>
                        <stop offset="1" stop-color="#7C4DFF"/>
                      </linearGradient>
                    </defs>
                  </svg>
                </span>
              </h1>
            </div>
            
            <!-- Subheadline -->
            <p class="text-lg md:text-xl mb-8 text-[#5a6184] leading-relaxed animate-slide-up" style="animation-delay: 0.3s">
              Compare and find the best mobile phone plans from all major carriers. Save up to 40% on your monthly bill.
            </p>

            <!-- Tagline -->
            <div class="overflow-hidden mb-8">
              <h2 class="text-3xl md:text-4xl gradient-text font-bold animate-slide-up" style="animation-delay: 0.3s">
                Switch, Save, Smile!
              </h2>
            </div>

            <!-- Description -->
            <div class="overflow-hidden mb-10">
              <p class="text-black text-lg animate-slide-up" style="animation-delay: 0.4s">
                Compare all major Canadian carriers in seconds. Find the best plan tailored to your needs with our Best In Class recommendation engine.
              </p>
            </div>

            <!-- CTA buttons -->
            <div class="flex flex-wrap gap-4 animate-slide-up" style="animation-delay: 0.5s">
              <a href="#compare" class="magnetic-btn py-4 px-8 rounded-full bg-accent hover:bg-accent/90 text-white font-medium shadow-lg shadow-accent/25 transition-all flex items-center gap-2">
                <span>Find My Plan</span>
                <i class="ri-arrow-right-line"></i>
              </a>
            </div>

            <!-- Stats -->
            <div class="mt-12 grid grid-cols-3 gap-6 animate-slide-up" style="animation-delay: 0.6s">
              <div>
                <div class="text-2xl font-display font-bold gradient-text">8+</div>
                <div class="text-black text-sm">Major Carriers</div>
            </div>
              <div>
                <div class="text-2xl font-display font-bold gradient-text">100+</div>
                <div class="text-black text-sm">Plans Compared</div>
            </div>
              
          </div>
        </div>
        
        <!-- Carrier logos grid -->
        <div class="mt-16 animate-slide-up" style="animation-delay: 0.7s; z-index: 3;">
          <div class="bg-[rgba(218,228,255,0.9)] rounded-3xl p-6 md:p-10 max-w-5xl mx-0 lg:mr-auto shadow-lg">
            <h3 class="text-xl md:text-2xl gradient-text font-display font-family:helvetica  mb-6 md:mb-10 text-center text-[#2a3158]"> Your Favourite Carriers All In One Place</h3>
            <div class="grid grid-cols-2 sm:grid-cols-4 gap-8 md:gap-16">
              <!-- Row 1 -->
          <!-- Bell -->
              <a href="/all-plans?carrier=Bell" class="carrier-logo flex justify-center">
                <img src="/carrierlogos/images.png" alt="Bell" class="max-h-16 md:max-h-24 object-contain" />
          </a>
              
          <!-- Rogers -->
              <a href="/all-plans?carrier=Rogers" class="carrier-logo flex justify-center">
                <img src="/carrierlogos/Rogers_logo.svg.png" alt="Rogers" class="max-h-16 md:max-h-24 object-contain" />
          </a>
          <!-- Telus -->
              <a href="/all-plans?carrier=Telus" class="carrier-logo flex justify-center">
                <img src="/carrierlogos/Telus-Logo-1996.png" alt="Telus" class="max-h-16 md:max-h-24 object-contain" />
          </a>
              <!-- Freedom -->
              <a href="/all-plans?carrier=Freedom" class="carrier-logo flex justify-center">
                <img src="/carrierlogos/Freedom_Mobile_logo.svg.png" alt="Freedom" class="max-h-16 md:max-h-24 object-contain" />
              </a>
              <!-- Row 2 -->
          <!-- Virgin -->
              <a href="/all-plans?carrier=Virgin" class="carrier-logo flex justify-center">
                <img src="/carrierlogos/Virgin_Plus_Web.png" alt="Virgin" class="max-h-16 md:max-h-24 object-contain" />
          </a>
              
          <!-- Fido -->
              <a href="/all-plans?carrier=Fido" class="carrier-logo flex justify-center">
                <img src="/carrierlogos/Fido_Solutions_logo.svg.png" alt="Fido" class="max-h-16 md:max-h-24 object-contain" />
          </a>
          <!-- Koodo -->
              <a href="/all-plans?carrier=Koodo" class="carrier-logo flex justify-center">
                <img src="/carrierlogos/Koodo_Mobile_-_Color.png" alt="Koodo" class="max-h-16 md:max-h-24 object-contain" />
          </a>
              
          <!-- Chatr -->
              <a href="/all-plans?carrier=Chatr" class="carrier-logo flex justify-center">
                <img src="/carrierlogos/png-clipart-chatr-mobile-phones-rogers-wireless-mobile-service-provider-company-lucky-mobile-chatr-purple-violet.png" alt="Chatr" class="max-h-16 md:max-h-24 object-contain" />
          </a>
        </div>
      </div>
        </div>
      
      <!-- Scroll indicator -->
      <div class="absolute bottom-8 left-1/2 -translate-x-1/2 flex flex-col items-center gap-2 animate-pulse-slow cursor-pointer hover:opacity-100 transition-all duration-300" id="scroll-to-explore">
        <span class="text-black/60 text-sm">Scroll to explore</span>
        <i class="ri-arrow-down-line text-black/60"></i>
      </div>
    </section>

    <!-- Featured Plans Section -->
    <section id="featured-plans" class="py-20 w-full page-section bg-gradient">
      <div class="container mx-auto px-6">
        <div class="flex justify-between items-center mb-12">
          <h2 class="text-4xl font-display font-bold">Featured Plans</h2>
          <a href="/all-plans" class="magnetic-btn py-2 px-6 rounded-full bg-accent text-black font-medium hover:shadow-lg hover:shadow-accent/20 transition-all flex items-center gap-2">
            <span>View all plans</span>
            <i class="ri-arrow-right-line"></i>
          </a>
        </div>
        <!-- Featured Plans Carousel -->
        <div class="plan-carousel-container">
          <div class="plan-carousel" id="planCarousel">
            <!-- Plan cards will be dynamically inserted here -->
          </div>
          <button id="planCarouselPrev" class="carousel-button prev" onclick="slidePlans('prev')">
            <i class="ri-arrow-left-s-line text-2xl text-gray-700"></i>
      </button>
          <button id="planCarouselNext" class="carousel-button next" onclick="slidePlans('next')">
            <i class="ri-arrow-right-s-line text-2xl text-gray-700"></i>
      </button>
        </div>
    </div>
  </section>

    <!-- Prepaid Plans Section -->
    <section id="prepaid-plans" class="py-20 w-full page-section bg-white">
      <div class="container mx-auto px-6">
        <h2 class="text-4xl font-display font-bold text-center mb-12">Prepaid Plans</h2>
        <!-- Prepaid Plans Carousel -->
        <div class="plan-carousel-container">
          <div class="plan-carousel" id="prepaidCarousel">
            <!-- Prepaid plan cards will be dynamically inserted here -->
          </div>
          <button id="prepaidCarouselPrev" class="carousel-button prev" onclick="slidePrepaidPlans('prev')">
            <i class="ri-arrow-left-s-line text-2xl text-gray-700"></i>
      </button>
          <button id="prepaidCarouselNext" class="carousel-button next" onclick="slidePrepaidPlans('next')">
            <i class="ri-arrow-right-s-line text-2xl text-gray-700"></i>
      </button>
        </div>
    </div>
  </section>

    <!-- AI Recommendation Section with Chat -->
    <section class="py-24 w-full page-section bg-gradient" id="compare">
      <div class="container mx-auto px-6">
        <div class="text-center max-w-3xl mx-auto mb-16">
          <h3 class="text-sm uppercase tracking-wider text-accent mb-2 font-medium">Intelligent Recommendations</h3>
          <h2 class="text-4xl md:text-5xl font-display font-bold mb-6 text-black">Meet Blue, Your Personal Plan Advisor</h2>
          <p class="text-gray-700">Our AI assistant analyzes your usage patterns to recommend the perfect plan for your needs.</p>
        </div>
        <div class="grid lg:grid-cols-2 gap-8 max-w-6xl mx-auto relative">
          <!-- Info Column -->
          <div class="bg-white rounded-2xl p-8 shadow-xl border border-accent/10">
            <div class="space-y-8">
              <div class="space-y-6">
                <div class="flex items-center gap-4">
                  <div class="w-12 h-12 rounded-full bg-accent flex items-center justify-center text-white">
                    <i class="ri-brain-line text-xl"></i>
                  </div>
                  <div>
                    <h3 class="text-xl font-display font-bold text-black">Smart Recommendations</h3>
                    <p class="text-gray-700">Analyzes your data to find the best match</p>
                  </div>
                </div>
                <div class="flex items-center gap-4">
                  <div class="w-12 h-12 rounded-full bg-accent flex items-center justify-center text-white">
                    <i class="ri-time-line text-xl"></i>
                  </div>
                  <div>
                    <h3 class="text-xl font-display font-bold text-black">Save Time</h3>
                    <p class="text-gray-700">No more hours spent comparing plans</p>
                  </div>
                </div>
                <div class="flex items-center gap-4">
                  <div class="w-12 h-12 rounded-full bg-accent flex items-center justify-center text-white">
                    <i class="ri-money-dollar-circle-line text-xl"></i>
                  </div>
                  <div>
                    <h3 class="text-xl font-display font-bold text-black">Save Money</h3>
                    <p class="text-gray-700">Our users save $240/year on average</p>
                  </div>
                </div>
              </div>
              <button onclick="showPlanDetailsModal()" class="block w-full py-4 px-8 rounded-full bg-accent text-white font-medium text-center shadow-lg shadow-accent/25 transition-all hover:bg-accent/90">
                  <span class="flex items-center justify-center gap-2">
                    <i class="ri-message-3-line text-lg"></i>
                  <span>Find My Perfect Plan</span>
                  </span>
              </button>
              </div>
            </div>
          <!-- Chat Column -->
          <div class="bg-white rounded-2xl shadow-xl border border-accent/10 overflow-hidden">
            <div class="p-4 border-b border-accent/10 flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-accent flex items-center justify-center text-white">
                  <i class="ri-robot-line text-xl"></i>
                </div>
                <div>
                  <h3 class="font-display font-bold text-black">Blue</h3>
                  <div class="flex items-center gap-1.5 text-xs text-gray-700">
                    <span class="block w-2 h-2 rounded-full bg-green-400"></span>
                    <span>Online now</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="p-6 space-y-6 min-h-[400px] bg-gray-50" id="chat-messages">
              <!-- AI welcome message -->
              <div class="flex items-start gap-3 max-w-[80%]">
                <div class="w-8 h-8 rounded-full bg-accent flex items-center justify-center text-white shrink-0">
                  <i class="ri-robot-line text-sm"></i>
                </div>
                <div class="bg-white rounded-2xl rounded-tl-none p-4 shadow-md">
                  <p class="text-black">Hi there! ðŸ‘‹ I'm Blue, your personal plan advisor. To help you find the perfect mobile plan, could you share your current plan details with me?</p>
                  <button onclick="showPlanDetailsModal()" class="mt-4 w-full py-2 px-4 bg-accent/10 text-accent rounded-lg hover:bg-accent/20 transition-colors text-sm">
                    Share Plan Details
                  </button>
                </div>
              </div>
                </div>
            <div class="p-4 border-t border-accent/10 bg-white">
              <form id="chat-form" class="relative">
                <input type="text" 
                       id="chat-input" 
                       placeholder="Type your message..." 
                       class="w-full bg-gray-50 border border-accent/10 rounded-full py-3 px-5 pr-12 focus:outline-none focus:ring-2 focus:ring-accent/20">
                <button type="submit" 
                        class="absolute right-2 top-1/2 -translate-y-1/2 w-8 h-8 rounded-full bg-accent flex items-center justify-center text-white hover:bg-accent/90 transition-colors">
                  <i class="ri-send-plane-fill"></i>
                </button>
              </form>
                </div>
              </div>
            </div>
      </div>
    </section>

    <!-- Modal Dialog Box for Plan Details -->
    <div id="planDetailsModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
      <div class="bg-white rounded-2xl p-6 max-w-md w-full mx-4 shadow-2xl" 
           style="transform: translate(0, -20px); opacity: 0; transition: all 0.3s ease-out;">
        <div class="text-center mb-6">
          <h3 class="text-2xl font-display font-bold text-gray-800">Your Current Plan Details</h3>
          <p class="text-gray-600 mt-2">Help us find the perfect plan for you by sharing your current plan details.</p>
        </div>

        <form id="planDetailsForm" class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Current Plan Price ($)</label>
              <div class="relative">
              <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-500">$</span>
              <input type="number" 
                     name="planPrice" 
                     placeholder="0.00" 
                     min="0"
                     step="0.01"
                     class="w-full pl-8 pr-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-accent/20 focus:border-accent outline-none transition-all"
                     required>
            </div>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Current Data Usage (GB)</label>
            <div class="relative">
              <input type="number" 
                     name="dataUsage" 
                     placeholder="0" 
                     min="0"
                     step="0.1"
                     class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-accent/20 focus:border-accent outline-none transition-all"
                     required>
              <span class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-500">GB</span>
        </div>
      </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Current Provider</label>
            <select name="provider" 
                    class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-accent/20 focus:border-accent outline-none transition-all"
                    required>
              <option value="">Select your provider</option>
              <option value="Bell">Bell</option>
              <option value="Rogers">Rogers</option>
              <option value="Telus">Telus</option>
              <option value="Virgin">Virgin Plus</option>
              <option value="Fido">Fido</option>
              <option value="Koodo">Koodo</option>
              <option value="Freedom">Freedom Mobile</option>
              <option value="Chatr">Chatr</option>
              <option value="Public">Public Mobile</option>
              <option value="Lucky">Lucky Mobile</option>
            </select>
    </div>

          <div class="flex gap-3 mt-6">
            <button type="button" 
                    onclick="closePlanDetailsModal()"
                    class="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
              Cancel
            </button>
            <button type="submit" 
                    class="flex-1 px-4 py-2 bg-accent text-white rounded-lg hover:bg-accent/90 transition-colors">
              Find My Plan
            </button>
          </div>
        </form>
      </div>
    </div>

  <!-- Why Choose Us Section -->
    <section class="py-24 w-full page-section bg-white" id="about">
      <div class="container mx-auto px-6">
        <!-- Section header -->
        <div class="text-center max-w-3xl mx-auto mb-16">
          <h3 class="text-sm uppercase tracking-wider text-accent mb-2 font-medium">Why SwitchMyPlan</h3>
          <h2 class="text-4xl md:text-5xl font-display font-bold mb-6 text-black">The Smart Way to Choose</h2>
          <p class="text-gray-700">We've built the most advanced mobile plan comparison platform in Canada.</p>
        </div>
        
        <!-- Features grid -->
        <div class="grid md:grid-cols-3 gap-8 max-w-5xl mx-auto">
          <!-- Feature 1 -->
          <div class="bg-white rounded-2xl p-8 shadow-xl border border-accent/10">
            <div class="w-14 h-14 rounded-full bg-accent flex items-center justify-center text-white mb-6">
              <i class="ri-shield-check-line text-2xl"></i>
      </div>
            <h3 class="text-xl font-display font-bold mb-3 text-black">Trusted Comparisons</h3>
            <p class="text-gray-700">We analyze thousands of plans to ensure you get the best deal possible.</p>
            
            <div class="mt-6 pt-6 border-t border-gray-100">
              <div class="flex items-center gap-2 text-gray-700">
                <i class="ri-check-line text-accent"></i>
                <span>Daily updated plan details</span>
        </div>
      </div>
        </div>
          
          <!-- Feature 2 -->
          <div class="bg-white rounded-2xl p-8 shadow-xl border border-accent/10 ribbon-container">
            <div class="ribbon">Coming Soon</div>
            <div class="w-14 h-14 rounded-full bg-accent flex items-center justify-center text-white mb-6">
              <i class="ri-robot-line text-2xl"></i>
            </div>
            <h3 class="text-xl font-display font-bold mb-3 text-black">AI-Powered</h3>
            <p class="text-gray-700">Blue provides personalized recommendations based on your usage.</p>
            
            <div class="mt-6 pt-6 border-t border-gray-100">
              <div class="flex items-center gap-2 text-gray-700">
                <i class="ri-check-line text-accent"></i>
                <span>Smart suggestions</span>
              </div>
            </div>
          </div>
          
          <!-- Feature 3 -->
          <div class="bg-white rounded-2xl p-8 shadow-xl border border-accent/10">
            <div class="w-14 h-14 rounded-full bg-accent flex items-center justify-center text-white mb-6">
              <i class="ri-timer-line text-2xl"></i>
            </div>
            <h3 class="text-xl font-display font-bold mb-3 text-black">Save Time & Money</h3>
            <p class="text-gray-700">Our users save an average of $240 annually on their plans.</p>
            
            <div class="mt-6 pt-6 border-t border-gray-100">
              <div class="flex items-center gap-2 text-gray-700">
                <i class="ri-check-line text-accent"></i>
                <span>Quick comparison</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Our Mission Section -->
    <section id="our-mission" class="py-24 w-full page-section bg-gradient">
      <!-- inner content stays centered -->
      <div class="max-w-5xl mx-auto px-6">
        <h3 class="text-4xl md:text-6xl font-display font-bold mb-6 text-black">
          Our Mission
        </h3>
        <p class="text-2xl md:text-4xl leading-relaxed text-gray-700">
          At SwitchMyPlan, our mission is to empower customers with clear and unbiased plan comparisons. We understand that carriers often favor new subscribers, leaving long-time customers with outdated, costly plans. Our technology-driven service, guided by our virtual advisor Blue, simplifies switching so you get the fair value and respect you deserve.
        </p>
      </div>
    </section>
  
  <!-- Footer -->
    <footer class="backdrop-blur-sm border-t border-accent/10 py-16 relative">
      <!-- Background pattern -->
      <div class="absolute inset-0 z-0 opacity-5">
        <div class="absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-accent/30 to-transparent"></div>
        <div class="grid grid-cols-10 h-full">
          <div class="border-r border-accent/10"></div>
          <div class="border-r border-accent/10"></div>
          <div class="border-r border-accent/10"></div>
          <div class="border-r border-accent/10"></div>
          <div class="border-r border-accent/10"></div>
          <div class="border-r border-accent/10"></div>
          <div class="border-r border-accent/10"></div>
          <div class="border-r border-accent/10"></div>
          <div class="border-r border-accent/10"></div>
          <div></div>
        </div>
      </div>
      
      <!-- Tagline scroller -->
      <div class="relative overflow-hidden mb-16 border-y border-accent/10 py-4">
        <div class="marquee-content flex gap-4 text-lg font-display font-semibold text-accent whitespace-nowrap">
          <div class="flex gap-12 items-center">
            <span>Switch, Save, Smile!</span>
            <span class="w-2 h-2 rounded-full bg-accent/30"></span>
            <span>Switch, Save, Smile!</span>
            <span class="w-2 h-2 rounded-full bg-accent/30"></span>
            <span>Switch, Save, Smile!</span>
            <span class="w-2 h-2 rounded-full bg-accent/30"></span>
            <span>Switch, Save, Smile!</span>
            <span class="w-2 h-2 rounded-full bg-accent/30"></span>
            <span>Switch, Save, Smile!</span>
            <span class="w-2 h-2 rounded-full bg-accent/30"></span>
            <span>Switch, Save, Smile!</span>
          </div>
          <div class="flex gap-12 items-center">
            <span>Switch, Save, Smile!</span>
            <span class="w-2 h-2 rounded-full bg-accent/30"></span>
            <span>Switch, Save, Smile!</span>
            <span class="w-2 h-2 rounded-full bg-accent/30"></span>
            <span>Switch, Save, Smile!</span>
            <span class="w-2 h-2 rounded-full bg-accent/30"></span>
            <span>Switch, Save, Smile!</span>
            <span class="w-2 h-2 rounded-full bg-accent/30"></span>
            <span>Switch, Save, Smile!</span>
            <span class="w-2 h-2 rounded-full bg-accent/30"></span>
            <span>Switch, Save, Smile!</span>
          </div>
        </div>
      </div>
      
      <div class="container mx-auto px-6 relative z-10">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-12">
          <!-- Brand section -->
          <div class="space-y-6">
            <a href="#" class="text-4xl font-['Apple_Garamond'] font-bold" style="font-size: 2.5rem;">
              <span class="text-black">Switch</span><span class="gradient-text">My</span><span class="text-black">Plan</span>
            </a>
            <p class="text-gray-600">Helping Canadians find the best mobile plans.</p>
            
            <!-- Social icons -->
        <div class="flex space-x-4">
              <a href="#" class="h-10 w-10 rounded-full bg-accent/5 flex items-center justify-center text-accent hover:bg-accent/10 transition-colors">
                <i class="ri-twitter-fill"></i>
              </a>
              <a href="#" class="h-10 w-10 rounded-full bg-accent/5 flex items-center justify-center text-accent hover:bg-accent/10 transition-colors">
                <i class="ri-facebook-fill"></i>
              </a>
              <a href="#" class="h-10 w-10 rounded-full bg-accent/5 flex items-center justify-center text-accent hover:bg-accent/10 transition-colors">
                <i class="ri-instagram-line"></i>
              </a>
              <a href="#" class="h-10 w-10 rounded-full bg-accent/5 flex items-center justify-center text-accent hover:bg-accent/10 transition-colors">
                <i class="ri-linkedin-fill"></i>
              </a>
        </div>
      </div>
          
          <!-- Plans -->
      <div>
            <h4 class="font-bold text-lg mb-6 text-gray-800">Plans</h4>
            <ul class="space-y-3">
                <li><a href="all-plans.html" class="text-gray-600 hover:text-accent transition-colors" style="font-family: Helvetica, Arial, sans-serif;">All Plans</a></li>
                <li><a href="faq.html" class="text-gray-600 hover:text-accent transition-colors" style="font-family: Helvetica, Arial, sans-serif;">FAQ</a></li>
                </ul>
      </div>
          
          <!-- Company -->
      <div>
            <h4 class="font-bold text-lg mb-6 text-gray-800">Company</h4>
            <ul class="space-y-4">
              <li><a href="about.html" class="text-gray-600 hover:text-accent transition-colors">About Us</a></li>
              <li><a href="contact.html" class="text-gray-600 hover:text-accent transition-colors" style="font-family: Helvetica, Arial, sans-serif;">Contact</a></li>
        </ul>
      </div>
          
          <!-- Legal -->
      <div>
            <h4 class="font-bold text-lg mb-6 text-gray-800">Legal</h4>
            <ul class="space-y-4">
              <li><a href="privacy-policy.html" class="text-gray-600 hover:text-accent transition-colors" style="font-family: Helvetica, Arial, sans-serif;">Privacy Policy</a></li>
              <li><a href="https://crtc.gc.ca/eng/internet/codesimpl.htm" class="text-gray-600 hover:text-accent transition-colors">CRTC</a></li>
        </ul>
      </div>
    </div>
        
        <!-- Bottom links -->
        <div class="mt-16 pt-8 border-t border-accent/10 flex flex-col md:flex-row justify-between items-center text-sm text-gray-500">
          <div>Â© 2025 SwitchMyPlan. All rights reserved.</div>
          
          <div class="flex gap-6 mt-4 md:mt-0">
            <a href="#" class="hover:text-accent transition-colors">Sitemap</a>
            <a href="#" class="hover:text-accent transition-colors">FAQ</a>
            <a href="#" class="hover:text-accent transition-colors">Support</a>
          </div>
        </div>
    </div>
  </footer>
</main>

  <!-- External Libraries -->
  <script src="https://unpkg.com/splitting/dist/splitting.js"></script>
  <script src="https://unpkg.com/scrollreveal"></script>
  <script src="https://unpkg.com/vanilla-tilt"></script>

  <!-- Initialize components -->
<script>
    // Initialize ScrollReveal
    ScrollReveal().reveal('.reveal-fade', { 
      distance: '0px',
      duration: 1000,
      easing: 'cubic-bezier(0.5, 0, 0, 1)',
      interval: 100
    });

    ScrollReveal().reveal('.reveal-slide-up', {
      distance: '20px',
      origin: 'bottom',
      duration: 1000,
      easing: 'cubic-bezier(0.5, 0, 0, 1)',
      interval: 100
    });

    // Initialize Splitting
    Splitting();

    // Initialize VanillaTilt for cards
    VanillaTilt.init(document.querySelectorAll(".hero-card"), {
      max: 5,
      speed: 400,
      glare: true,
      "max-glare": 0.2,
    });

    // Magnetic buttons
    const buttons = document.querySelectorAll('.magnetic-btn');
    buttons.forEach(btn => {
      btn.addEventListener('mousemove', (e) => {
        const rect = btn.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        
        const centerX = rect.width / 2;
        const centerY = rect.height / 2;
        
        const deltaX = x - centerX;
        const deltaY = y - centerY;
        
        const distance = Math.sqrt(deltaX ** 2 + deltaY ** 2);
        const maxDistance = Math.sqrt(centerX ** 2 + centerY ** 2);
        
        const strength = 0.5;
        const targetX = deltaX * strength * (distance / maxDistance);
        const targetY = deltaY * strength * (distance / maxDistance);
        
        btn.style.transform = `translate(${targetX}px, ${targetY}px)`;
      });
      
      btn.addEventListener('mouseleave', () => {
        btn.style.transform = '';
      });
    });

    // Mobile menu
    const menuButton = document.querySelector('.mobile-menu-button');
    const closeButton = document.querySelector('#close-menu');
    const mobileMenu = document.querySelector('#mobile-menu');
    
    if (menuButton && mobileMenu) {
      menuButton.addEventListener('click', () => {
        mobileMenu.classList.add('active');
      document.body.style.overflow = 'hidden';
    });
    
      if (closeButton) {
      closeButton.addEventListener('click', () => {
        mobileMenu.classList.remove('active');
      document.body.style.overflow = '';
    });
      }

      // Close menu when clicking a link
      const mobileMenuLinks = mobileMenu.querySelectorAll('a');
      if (mobileMenuLinks.length > 0) {
        mobileMenuLinks.forEach(link => {
        link.addEventListener('click', () => {
          mobileMenu.classList.remove('active');
          document.body.style.overflow = '';
        });
      });
      }
    }

    // Navbar scroll effect
    const navbar = document.getElementById('navbar');
    let lastScroll = 0;
    
    window.addEventListener('scroll', () => {
      const currentScroll = window.pageYOffset;
      
      if (currentScroll <= 0) {
        navbar.classList.remove('scrolled');
        return;
      }
      
      if (currentScroll > lastScroll && !navbar.classList.contains('scrolled')) {
        navbar.classList.add('scrolled');
      } else if (currentScroll < lastScroll && navbar.classList.contains('scrolled')) {
        navbar.classList.remove('scrolled');
      }
      
      lastScroll = currentScroll;
    });

    // Create background particles
    function createParticles() {
      const container = document.querySelector('.particles-container');
      const particleCount = 50;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'absolute w-1 h-1 rounded-full bg-accent/20';
        
        // Random position
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        
        // Random size
        const size = Math.random() * 3 + 1;
        particle.style.width = size + 'px';
        particle.style.height = size + 'px';
        
        // Random animation
        particle.style.animation = `float ${Math.random() * 3 + 3}s ease-in-out infinite`;
        particle.style.animationDelay = Math.random() * 5 + 's';
        
        container.appendChild(particle);
      }
    }

    // Create stars
    function createStars() {
      const container = document.querySelector('.particles-container');
      const starCount = 20;
      
      for (let i = 0; i < starCount; i++) {
        const star = document.createElement('div');
        star.className = 'absolute';
        
        // Star shape using box-shadow
        star.style.boxShadow = '0 0 2px 2px rgba(68, 112, 255, 0.3)';
        star.style.width = '2px';
        star.style.height = '2px';
        star.style.borderRadius = '50%';
        star.style.backgroundColor = 'rgba(68, 112, 255, 0.5)';
        
        // Random position
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        
        // Random animation
        star.style.animation = `pulse ${Math.random() * 2 + 2}s ease-in-out infinite`;
        star.style.animationDelay = Math.random() * 3 + 's';
        
        container.appendChild(star);
      }
    }

    // Initialize particles and stars
    document.addEventListener('DOMContentLoaded', () => {
      createParticles();
      createStars();
      loadPlans(); // Add this line to load the plans when the page loads
    });

    // Global variables for carousel management
    let currentSlide = 0;
    let slidesPerView = 3;
    let totalPlans = 0;

    // Function to determine number of slides per view based on screen width
    function getSlidesPerView() {
      if (window.innerWidth <= 767) {
        return 1;
      } else if (window.innerWidth <= 1023) {
        return 2;
      } else {
        return 3;
      }
    }

    // Initialize responsive behavior
    window.addEventListener('load', function() {
      slidesPerView = getSlidesPerView();
    });

    // Update carousel on window resize
    window.addEventListener('resize', function() {
      const newSlidesPerView = getSlidesPerView();
      if (newSlidesPerView !== slidesPerView) {
        slidesPerView = newSlidesPerView;
        updateCarousel();
      }
    });

    function updateCarousel() {
      const carouselContainer = document.querySelector('.carousel-container');
      if (!carouselContainer) return;
      
      const maxSlide = Math.max(0, totalPlans - slidesPerView);
      currentSlide = Math.min(currentSlide, maxSlide);
      
      const cardWidth = getCardWidth();
      carouselContainer.style.transform = `translateX(-${currentSlide * cardWidth}px)`;
      
      updateNavButtons();
    }

    function getCardWidth() {
      const card = document.querySelector('.plan-card');
      if (!card) return 0;
      return card.offsetWidth + 20; // Width + margin
    }

    function updateNavButtons() {
      const prevButton = document.querySelector('.carousel-nav button:first-child');
      const nextButton = document.querySelector('.carousel-nav button:last-child');
      
      if (!prevButton || !nextButton) return;
      
      prevButton.disabled = currentSlide <= 0;
      nextButton.disabled = currentSlide >= totalPlans - slidesPerView;
    }

    function prevSlide() {
      if (currentSlide > 0) {
        currentSlide--;
        updateCarousel();
      }
    }

    function nextSlide() {
      const maxSlide = totalPlans - slidesPerView;
      if (currentSlide < maxSlide) {
        currentSlide++;
        updateCarousel();
      }
    }

    // Modified displayPlans function to work with the new carousel
    function displayPlans(plans) {
      const chatContainer = document.querySelector('.chat-container');
      const filteredPlans = plans.filter(plan => plan.name && plan.price);
      totalPlans = filteredPlans.length;
      currentSlide = 0;
      slidesPerView = getSlidesPerView();
      
      let carouselHtml = '';
      
      if (filteredPlans.length === 0) {
        carouselHtml = `
          <div class="no-plans-message">
            <p>No plans found that match your criteria. Try adjusting your requirements.</p>
          </div>
        `;
      } else {
        // Create carousel wrapper and container
        carouselHtml = `
          <div class="carousel-wrapper">
            <div class="carousel-container">
              ${filteredPlans.map(plan => `
                <div class="plan-card">
                  <h3>${plan.name}</h3>
                  <p class="price">$${plan.price}/month</p>
                  <p class="data">${plan.data} GB</p>
                  <p>${plan.description || 'No description available'}</p>
                  <a href="${plan.link || '#'}" class="view-plan-btn" target="_blank">View Plan</a>
                </div>
              `).join('')}
            </div>
          </div>
          <div class="carousel-nav">
            <button onclick="prevSlide()" disabled><i class="fas fa-chevron-left"></i></button>
            <button onclick="nextSlide()"><i class="fas fa-chevron-right"></i></button>
          </div>
        `;
      }
      
      // Add the carousel HTML to the chat
      const plansMessage = document.createElement('div');
      plansMessage.className = 'message bot';
      plansMessage.innerHTML = `
        <div class="message-content">
          <p>Here are some plans that match your requirements:</p>
          ${carouselHtml}
        </div>
      `;
      
      chatContainer.appendChild(plansMessage);
      chatContainer.scrollTop = chatContainer.scrollHeight;
      
      // Initialize carousel navigation
      updateNavButtons();
    }

    // Function to create a plan card
    function createPlanCard(plan) {
      console.log('Creating card for plan:', plan);

      const bestValueBadge = plan.best_value ? `
        <div class="absolute -top-3 -right-3 bg-accent/20 backdrop-blur-sm text-base px-3 py-1 rounded-full text-gray-800 border border-accent/30">Best Value</div>
      ` : '';

      const networkSpeedText = ['Chatr', 'Lucky', 'Public Mobile'].includes(plan.carrier) ? '4G network speeds' : 
                            ['Virgin', 'Fido', 'Koodo'].includes(plan.carrier) ? '4G network speeds' : '5G network speeds';


      // Set features based on carrier
      let features = [];
      switch(plan.carrier) {
        case 'Bell':
case 'Rogers':
case 'Telus':
    if (plan.plan_features) {
        features = plan.plan_features.split('\n')
            .map(feature => {
                const cleanFeature = feature.trim()
                    .replace(/^[â€¢\-\s]+/, '')
                    .replace(/^and\s+/, '')
                    .trim();
                return cleanFeature ? { text: cleanFeature, included: true } : null;
            })
            .filter(feature => feature !== null);
    }
    // Fallback default features if splitting yields no valid items
    if (!features || features.length === 0) {
        features = [
            { text: `${plan.data} of 5G Unlimited Data`, included: true },
            { text: 'Unlimited Talk & Text', included: true }
            
        ];
    }
    break;
        case 'Virgin':
          features = [
            { text: 'Unlimited Talk & Text', included: true },
            { text: 'Unlimited calling to US, India, UK and other countries', included: true },
            { text: 'Unlimited International Texting', included: true },
            { text: 'Call Forwarding', included: true }
          ];
          break;
        case 'Koodo':
          features = [
            { text: 'Unlimited Talk & Text', included: true },
            { text: '1 free perk to choose from:', included: true },
            { text: 'Rollover Data', included: true },
            { text: 'Unlimited Long Distance Pack', included: true },
            { text: 'International Texting', included: true }
          ];
          break;
        case 'Fido':
          features = [
            { text: 'Unlimited Talk & Text', included: true },
            { text: `${plan.data} of 4G LTE Data`, included: true },
            { text: 'Data Overage Protection', included: true },
            { text: '5 Hours Unlimited Data', included: true }
            
          ];
          break;
        case 'Freedom':
          features = [
            { text: 'CA/US/Mexico Unlimited Data,Talk & Text', included: true },
            { text: '1000 International Minutes to 18 destinations', included: true },
            { text: 'Conference Calling', included: true },
            { text: 'Data Protection', included: true }
          ];
          break;
        default:
          features = [
            { text: 'Unlimited Talk & Text', included: true },
            { text: `${plan.data} of Data`, included: true },
            { text: 'Canada-wide Coverage', included: true },
            { text: 'Call Display', included: true },
            { text: 'Voicemail', included: true }
          ];
      }

      return `
        <div class="w-full">
          <div class="plan-card relative shadow-xl hover:shadow-2xl transition-all" data-carrier="${plan.carrier}">
            ${bestValueBadge}
            <div class="shine"></div>
            
            <!-- Card Header -->
            <div class="plan-card-header">
              <div class="carrier-logo">
                <img src="/carrierlogos/${getCarrierLogoFilename(plan.carrier)}" 
                     alt="${plan.carrier}" 
                     class="h-full w-auto object-contain">
              </div>
              <div class="price-text">
                $${plan.price}<span class="price-suffix">/mo</span>
              </div>
            </div>
            
            <!-- Plan Name -->
            <div class="plan-card-name">
              <div class="text-2xl font-display font-bold text-gray-800 mb-2">${
                plan.carrier === 'Koodo' 
                  ? (plan.data === '0' || plan.data === '0MB' || plan.data === '0GB' 
                    ? plan.plan_name 
                    : (plan.data.includes('MB') 
                      ? `${plan.data.replace('GB', '')}` 
                      : `${parseFloat(plan.data)} GB`))
                  : plan.plan_name
              }</div>
              <div class="flex items-center gap-2 text-gray-500">
                <i class="ri-speed-up-line"></i>
                <span>${networkSpeedText}</span>
              </div>
            </div>
            
            <!-- Features (Scrollable) -->
            <div class="plan-card-features">
              <div class="space-y-2">
                ${features.map(feature => `
                  <div class="feature-item">
                    <div class="feature-icon">
                      <i class="ri-${feature.included ? 'check' : 'close'}-line"></i>
                    </div>
                    <span class="feature-text">${feature.text}</span>
                  </div>
                `).join('')}
              </div>
            </div>
            
            <!-- Footer -->
            <div class="plan-card-footer">
              <div class="text-xs text-gray-500">New activations only. No Contract. No Connection fee.</div>
              <a href="javascript:void(0)" 
                 onclick="selectPlan('${plan.carrier}', ${plan.price}, '${plan.data}', '${plan.id}', '${plan.plan_name}')"
                 class="select-plan-button">
                Select ${plan.carrier} Plan
              </a>
            </div>
          </div>
        </div>
      `;
    }


    // Function to get the correct logo filename for a carrier
    function getCarrierLogoFilename(carrier) {
      const logoMap = {
        'Virgin': 'Virgin_Plus_Web.png',
        'Fido': 'Fido_Solutions_logo.svg.png',
        'Koodo': 'Koodo_Mobile_-_Color.png',
        'Freedom': 'Freedom_Mobile_logo.svg.png',
        'Bell': 'images.png',
        'Rogers': 'Rogers_logo.svg.png',
        'Telus': 'Telus-Logo-1996.png',
        'Chatr': 'png-clipart-chatr-mobile-phones-rogers-wireless-mobile-service-provider-company-lucky-mobile-chatr-purple-violet.png',
        'Public Mobile': 'public-mobile-logo.png',
        'Lucky': 'lucky-mobile-logo.png'
      };
      return logoMap[carrier] || `${carrier.toLowerCase()}_logo.png`;
    }

    // Function to normalize data to GB
    function normalizeDataToGB(dataStr) {
      const value = parseFloat(dataStr);
      if (dataStr.toLowerCase().includes('mb')) {
        return value / 1024;  // Convert MB to GB
      }
      return value;  // Already in GB
    }

    // Function to load and display plans
    async function loadPlans() {
      try {
        console.log('Starting to load plans...');
        
        const planCarousel = document.getElementById('planCarousel');
        const prepaidCarousel = document.getElementById('prepaidCarousel');
        
        if (!planCarousel || !prepaidCarousel) {
          console.error('Could not find carousel elements');
          throw new Error('Carousel elements not found');
        }
        
        planCarousel.innerHTML = '<div class="w-full flex items-center justify-center min-h-[520px]"><div class="animate-spin rounded-full h-12 w-12 border-4 border-accent border-t-transparent"></div></div>';
        prepaidCarousel.innerHTML = '<div class="w-full flex items-center justify-center min-h-[520px]"><div class="animate-spin rounded-full h-12 w-12 border-4 border-accent border-t-transparent"></div></div>';

        // Get the current page's origin to use as base URL
        const baseUrl = window.location.origin;
        console.log('Using base URL:', baseUrl);

        // Fetch plans
        const [featuredResponse, prepaidResponse] = await Promise.all([
          fetch(`${baseUrl}/api/plans/featured`),
          fetch(`${baseUrl}/api/plans/prepaid`)
        ]);

        if (!featuredResponse.ok || !prepaidResponse.ok) {
          throw new Error('Failed to fetch plans');
        }

        const [featuredPlans, prepaidPlans] = await Promise.all([
          featuredResponse.json(),
          prepaidResponse.json()
        ]);

        // Process plans to ensure plan_features are parsed correctly
        const processedFeaturedPlans = featuredPlans.map(plan => {
          // Ensure plan_features is properly formatted if it exists
          if (plan.plan_features && typeof plan.plan_features === 'string') {
            // Already a string, no need to transform
            return plan;
          } else if (plan.plan_features && Array.isArray(plan.plan_features)) {
            // Convert array to string with newlines
            return {
              ...plan,
              plan_features: plan.plan_features.join('\n')
            };
          } else {
            // No plan_features or invalid format
            return plan;
          }
        });

        // Define target criteria
        const TARGET_PRICE = 50;  // Average plan price
        const MIN_DATA_GB = 1;    // Minimum 1GB data
        const TARGET_DATA = 30;   // Target data in GB
        
        // Function to score a plan based on our criteria
        function scorePlan(plan) {
          const normalizedData = normalizeDataToGB(plan.data);
          
          // Skip plans with too little data
          if (normalizedData < MIN_DATA_GB) {
            return { plan, score: -1 };
          }
          
          const priceScore = plan.price <= TARGET_PRICE ? 1 : 0;
          const dataScore = normalizedData >= TARGET_DATA ? 1 : 
                           normalizedData >= TARGET_DATA * 0.8 ? 0.8 : 
                           normalizedData / TARGET_DATA;
          
          // Calculate value ratio (data per dollar)
          const valueRatio = normalizedData / plan.price;
          
          return {
            plan,
            score: priceScore + dataScore + valueRatio,
            normalizedData
          };
        }

        // Function to get best plan for each carrier
        function getBestPlanForCarrier(plans, carrier) {
          const carrierPlans = plans.filter(plan => plan.carrier === carrier);
          if (!carrierPlans.length) return null;
          
          const scoredPlans = carrierPlans.map(scorePlan)
            .filter(scored => scored.score > 0)  // Filter out plans with too little data
            .sort((a, b) => b.score - a.score);
          
          return scoredPlans.length > 0 ? scoredPlans[0].plan : null;
        }

        // Filter and get best plans for each carrier
        const priorityCarriers = ['Virgin', 'Fido', 'Koodo', 'Freedom', 'Bell', 'Rogers', 'Telus'];
        const selectedPlans = priorityCarriers
          .map(carrier => getBestPlanForCarrier(processedFeaturedPlans, carrier))
          .filter(plan => plan !== null);

        // Filter prepaid plans
        const prepaidCarriers = ['Chatr', 'Lucky', 'Public Mobile'];
        const filteredPrepaidPlans = prepaidPlans
          .filter(plan => {
            const normalizedData = normalizeDataToGB(plan.data);
            return prepaidCarriers.includes(plan.carrier) && normalizedData >= MIN_DATA_GB;
          })
          .sort((a, b) => prepaidCarriers.indexOf(a.carrier) - prepaidCarriers.indexOf(b.carrier));

        // Insert plans into carousels
        if (selectedPlans.length > 0) {
          planCarousel.innerHTML = selectedPlans
            .map(plan => createPlanCard({
              ...plan,
              best_value: determineBestValue(plan, selectedPlans)
            }))
            .join('');
        } else {
          planCarousel.innerHTML = '<div class="w-full text-center py-8">No featured plans available at the moment.</div>';
        }

        if (filteredPrepaidPlans.length > 0) {
          prepaidCarousel.innerHTML = filteredPrepaidPlans
            .map(plan => createPlanCard({
              ...plan,
              best_value: determineBestValue(plan, filteredPrepaidPlans)
            }))
            .join('');
        } else {
          prepaidCarousel.innerHTML = '<div class="w-full text-center py-8">No prepaid plans available at the moment.</div>';
        }

        // Initialize carousel functionality
        initializeCarousel();
        
        // Apply specific carrier styling after rendering
        applyCarrierSpecificStyling();
        
      } catch (error) {
        console.error('Error loading plans:', error);
        const errorMessage = `
          <div class="w-full flex flex-col items-center justify-center min-h-[520px] text-center p-8">
            <i class="ri-error-warning-line text-4xl text-red-500 mb-4"></i>
            <p class="text-gray-700 mb-2">Unable to load plans at the moment.</p>
            <p class="text-sm text-gray-500 mb-4">${error.message}</p>
            <button onclick="loadPlans()" class="px-6 py-2 bg-accent text-white rounded-full hover:bg-accent/90 transition-colors">
              Try Again
            </button>
          </div>
        `;
  
        if (planCarousel) planCarousel.innerHTML = errorMessage;
        if (prepaidCarousel) prepaidCarousel.innerHTML = errorMessage;
      }
    }

    // Function to apply carrier-specific styling
    function applyCarrierSpecificStyling() {
      // Apply Virgin-specific styling
      document.querySelectorAll('.plan-card[data-carrier="Virgin"] .carrier-logo img').forEach(img => {
        img.style.transform = 'scale(1.3)';
        img.style.maxWidth = 'none';
      });
      
      // Apply Koodo-specific styling
      document.querySelectorAll('.plan-card[data-carrier="Koodo"] .carrier-logo img').forEach(img => {
        img.style.transform = 'scale(1.9)';
        img.style.maxWidth = 'none';
      });
    }

    // Helper function to determine if a plan is the best value
    function determineBestValue(plan, allPlans) {
      const normalizedPlans = allPlans.map(p => ({
        ...p,
        normalizedData: normalizeDataToGB(p.data)
      }));
      
      // Calculate scores
      const scores = normalizedPlans.map(p => ({
        plan: p,
        ratio: p.normalizedData / p.price,
        priceScore: p.price <= 50 ? 1 : 0,
        dataScore: p.normalizedData >= 30 ? 1 : p.normalizedData / 30
      }));
      
      // Calculate total score
      scores.forEach(s => {
        s.totalScore = s.ratio + s.priceScore + s.dataScore;
      });
      
      // Sort by total score
      scores.sort((a, b) => b.totalScore - a.totalScore);
      
      // Return true if this plan has the best score
      return scores[0].plan === plan;
    }

    // Initialize carousel functionality
    function initializeCarousel() {
      const planCarousel = document.getElementById('planCarousel');
      const prepaidCarousel = document.getElementById('prepaidCarousel');
      
      if (planCarousel) {
        // Reset position
        planCarousel.style.transform = 'translateX(0)';
        
        // Get slide count and per view
        const cards = planCarousel.children;
        const slideCount = cards.length;
        const slidesPerView = window.innerWidth < 768 ? 1 : 3;
        
        // Update button states
        updateCarouselButtons('plan', 0, slideCount, slidesPerView);
      }
      
      if (prepaidCarousel) {
        // Reset position
        prepaidCarousel.style.transform = 'translateX(0)';
        
        // Get slide count and per view
        const cards = prepaidCarousel.children;
        const slideCount = cards.length;
        const slidesPerView = window.innerWidth < 768 ? 1 : 3;
        
        // Update button states
        updateCarouselButtons('prepaid', 0, slideCount, slidesPerView);
      }
      
      // Add window resize handler
      window.addEventListener('resize', handleCarouselResize);
    }
    
    // Handle window resize for responsive carousel
    function handleCarouselResize() {
      const planCarousel = document.getElementById('planCarousel');
      const prepaidCarousel = document.getElementById('prepaidCarousel');
      
      if (planCarousel) {
        // Reset position on resize
        planCarousel.style.transform = 'translateX(0)';
        
        // Update button states
        const cards = planCarousel.children;
        const slideCount = cards.length;
        const slidesPerView = window.innerWidth < 768 ? 1 : 3;
        updateCarouselButtons('plan', 0, slideCount, slidesPerView);
      }
      
      if (prepaidCarousel) {
        // Reset position on resize
        prepaidCarousel.style.transform = 'translateX(0)';
        
        // Update button states
        const cards = prepaidCarousel.children;
        const slideCount = cards.length;
        const slidesPerView = window.innerWidth < 768 ? 1 : 3;
        updateCarouselButtons('prepaid', 0, slideCount, slidesPerView);
      }
    }

    // Function to slide plans
    function slidePlans(direction) {
      const carousel = document.getElementById('planCarousel');
      if (!carousel) return;
      
      const cards = carousel.children;
      const slideCount = cards.length;
      const slidesPerView = window.innerWidth < 768 ? 1 : 3;
      
      // Get current slide position
      const currentTransform = carousel.style.transform;
      let currentSlide = 0;
      if (currentTransform) {
        const match = currentTransform.match(/translateX\((-?\d+)px\)/);
        if (match && match[1]) {
          const cardWidth = cards[0]?.offsetWidth || 0;
          const gap = 16; // 1rem = 16px
          const slideWidth = cardWidth + gap;
          currentSlide = Math.round(Math.abs(parseInt(match[1])) / slideWidth);
        }
      }
      
      // Calculate the width of a single card including gap
      const cardWidth = cards[0]?.offsetWidth || 0;
      const gap = 16; // 1rem = 16px
      const slideWidth = cardWidth + gap;
      
      if (direction === 'next' && currentSlide < slideCount - slidesPerView) {
        currentSlide++;
      } else if (direction === 'prev' && currentSlide > 0) {
        currentSlide--;
      }
      
      const translateX = -currentSlide * slideWidth;
      carousel.style.transform = `translateX(${translateX}px)`;
      
      // Update button states
      updateCarouselButtons('plan', currentSlide, slideCount, slidesPerView);
    }

    // Function to slide prepaid plans
    function slidePrepaidPlans(direction) {
      const carousel = document.getElementById('prepaidCarousel');
      if (!carousel) return;
      
      const cards = carousel.children;
      const slideCount = cards.length;
      const slidesPerView = window.innerWidth < 768 ? 1 : 3;
      
      // Get current slide position
      const currentTransform = carousel.style.transform;
      let currentSlide = 0;
      if (currentTransform) {
        const match = currentTransform.match(/translateX\((-?\d+)px\)/);
        if (match && match[1]) {
          const cardWidth = cards[0]?.offsetWidth || 0;
          const gap = 16; // 1rem = 16px
          const slideWidth = cardWidth + gap;
          currentSlide = Math.round(Math.abs(parseInt(match[1])) / slideWidth);
        }
      }
      
      // Calculate the width of a single card including gap
      const cardWidth = cards[0]?.offsetWidth || 0;
      const gap = 16; // 1rem = 16px
      const slideWidth = cardWidth + gap;
      
      if (direction === 'next' && currentSlide < slideCount - slidesPerView) {
        currentSlide++;
      } else if (direction === 'prev' && currentSlide > 0) {
        currentSlide--;
      }
      
      const translateX = -currentSlide * slideWidth;
      carousel.style.transform = `translateX(${translateX}px)`;
      
      // Update button states
      updateCarouselButtons('prepaid', currentSlide, slideCount, slidesPerView);
    }

    // Function to update carousel button states
    function updateCarouselButtons(type, currentSlide, slideCount, slidesPerView) {
      const prevBtn = document.getElementById(`${type}CarouselPrev`);
      const nextBtn = document.getElementById(`${type}CarouselNext`);
      
      if (prevBtn) {
        prevBtn.disabled = currentSlide === 0;
        prevBtn.style.opacity = currentSlide === 0 ? '0.5' : '1';
      }
      
      if (nextBtn) {
        const maxSlide = slideCount - slidesPerView;
        nextBtn.disabled = currentSlide >= maxSlide;
        nextBtn.style.opacity = currentSlide >= maxSlide ? '0.5' : '1';
      }
    }

    // Call initializeCarousel when the page loads
    window.addEventListener('load', initializeCarousel);

    // Function to handle selecting a plan
    async function selectPlan(carrier, price, dataAmount, id, name) {
      try {
        console.log(`Selecting plan: ${carrier} - $${price} - ${dataAmount} - ${name}`);
        
        // Prepare the payload
          const payload = {
            carrier: carrier,
          price: parseFloat(price),
          data: dataAmount,
          id: id || '',
          plan_name: name || ''
        };
        
        // Make POST request to select_plan endpoint
        const baseUrl = window.location.origin;
        const response = await fetch(`${baseUrl}/select_plan`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(payload)
        });
        
          if (!response.ok) {
          throw new Error('Failed to select plan');
        }
        
        const result = await response.json();
        
        if (result.success) {
          // Check if this is a redirect response (for Fido plans)
          if (result.redirect && result.url) {
            // For Fido plans, redirect to their website
            window.location.href = result.url;
          } else {
            // For all other carriers, continue with normal checkout flow
            window.location.href = `${baseUrl}/checkout`;
          }
        } else {
          console.error('Error selecting plan:', result);
          alert('There was an error selecting your plan. Please try again.');
        }
      } catch (error) {
        console.error('Error in selectPlan:', error);
        alert('There was an error processing your request. Please try again.');
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Smooth scroll for navigation links
        document.querySelectorAll('.scroll-to, #scroll-to-explore').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                let targetId;
                
                // If this is the scroll-to-explore button, target featured plans
                if (this.id === 'scroll-to-explore') {
                    targetId = '#featured-plans';
                } else {
                    targetId = this.getAttribute('href');
                }
                
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    const headerOffset = 80; // Height of your fixed header
                    const elementPosition = targetElement.getBoundingClientRect().top;
                    const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

                    window.scrollTo({
                        top: offsetPosition,
                        behavior: 'smooth'
                    });
                }
            });
        });

        // Enhanced scroll indicator interaction
        const scrollExplore = document.getElementById('scroll-to-explore');
        if (scrollExplore) {
            scrollExplore.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-5px)';
                this.classList.add('opacity-100');
                this.classList.remove('opacity-60');
            });
            
            scrollExplore.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
                this.classList.remove('opacity-100');
                this.classList.add('opacity-60');
            });
        }

        // Hide scroll indicator when scrolling past hero section
        window.addEventListener('scroll', function() {
            const scrollExplore = document.getElementById('scroll-to-explore');
            const heroSection = document.getElementById('hero');
            
            if (scrollExplore && heroSection) {
                const heroBottom = heroSection.offsetTop + heroSection.offsetHeight;
                if (window.pageYOffset > heroBottom - window.innerHeight) {
                    scrollExplore.style.opacity = '0';
                } else {
                    scrollExplore.style.opacity = '0.6';
                }
            }
        });
    });

    // Function to show plan details modal
    function showPlanDetailsModal() {
      const modal = document.getElementById('planDetailsModal');
      const modalContent = modal.querySelector('div');
      
      // First make the container visible with flex
      modal.classList.remove('hidden');
      modal.classList.add('flex');
      
      // Then animate the modal content after a small delay
      setTimeout(() => {
        modalContent.style.opacity = '1';
        modalContent.style.transform = 'translate(0, 0)';
      }, 10);
    }

    // Function to close plan details modal
    function closePlanDetailsModal() {
      const modal = document.getElementById('planDetailsModal');
      const modalContent = modal.querySelector('div');
      
      // First animate out
      modalContent.style.opacity = '0';
      modalContent.style.transform = 'translate(0, -20px)';
      
      // Then hide the container after animation completes
      setTimeout(() => {
        modal.classList.remove('flex');
        modal.classList.add('hidden');
      }, 300);
    }
    
    // Handle the plan details form submission
    document.addEventListener('DOMContentLoaded', function() {
      const planDetailsForm = document.getElementById('planDetailsForm');
      if (planDetailsForm) {
        planDetailsForm.addEventListener('submit', async function(e) {
          e.preventDefault();
          
          // Get form data
          const formData = new FormData(planDetailsForm);
          const planPrice = formData.get('planPrice');
          const dataUsage = formData.get('dataUsage');
          const provider = formData.get('provider');
          
          // Close the modal
          closePlanDetailsModal();
          
          // Add a user message to the chat
          const chatMessages = document.getElementById('chat-messages');
          const userMessage = `
            <div class="flex items-start gap-3 max-w-[80%] ml-auto flex-row-reverse">
              <div class="w-8 h-8 rounded-full bg-accent flex items-center justify-center text-white shrink-0">
                <i class="ri-user-line text-sm"></i>
              </div>
              <div class="bg-accent/10 rounded-2xl rounded-tr-none p-4">
                <p class="text-black">I'm currently paying $${planPrice} for ${dataUsage}GB with ${provider}.</p>
              </div>
            </div>
          `;
          chatMessages.innerHTML += userMessage;
          
          // Add loading message
          const loadingMessage = `
            <div class="flex items-start gap-3 max-w-[80%] loading-message" id="loading-message">
              <div class="w-8 h-8 rounded-full bg-accent flex items-center justify-center text-white shrink-0">
                <i class="ri-robot-line text-sm"></i>
              </div>
              <div class="bg-white rounded-2xl rounded-tl-none p-4 shadow-md">
                <p class="text-black">Analyzing your plan details<span class="dots">...</span></p>
              </div>
            </div>
          `;
          chatMessages.innerHTML += loadingMessage;
          
          // Scroll to the bottom of the chat
          chatMessages.scrollTop = chatMessages.scrollHeight;
          
          try {
            // Make API call to get recommended plans
            const planDetails = {
              plan_price: parseFloat(planPrice),
              plan_data: parseFloat(dataUsage),
              carrier: provider,
              open_to_switch: true
            };
            
            // Fetch real plan recommendations from the backend
            const response = await fetch('/chat', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({
                userMessage: `I'm currently paying $${planPrice} for ${dataUsage}GB with ${provider}.`,
                planDetails: planDetails
              })
            });
            
            let recommendedPlans = [];
            
            if (response.ok) {
              const data = await response.json();
              
              // Remove loading message
              document.getElementById('loading-message').remove();
              
              // Check if we have an error message from the API
              if (data.error) {
                displayErrorMessage(chatMessages, data.error || 'Sorry, I encountered an issue while fetching plan recommendations. Please try again later.');
                return;
              }
              
              // Get the recommendations
              recommendedPlans = data.recommendedPlans || [];
              
              // Check if we have a message from the API
              const apiMessage = data.message || '';
              
              // Display recommendations with the message
              displayRecommendedPlans(recommendedPlans, chatMessages, apiMessage);
            } else {
              console.error('Failed to fetch recommendations:', await response.text());
              
              // Remove loading message
              document.getElementById('loading-message').remove();
              
              // Show error message instead of fabricating plans
              displayErrorMessage(chatMessages, 'Sorry, I encountered an issue while fetching plan recommendations. Please try again later.');
            }
            
          } catch (error) {
            console.error('Error fetching recommendations:', error);
            
            // Remove loading message if it exists
            const loadingMessage = document.getElementById('loading-message');
            if (loadingMessage) {
              loadingMessage.remove();
            }
            
            // Show error message instead of fabricating plans
            displayErrorMessage(chatMessages, 'Sorry, something went wrong while trying to find plans for you. Please try again later.');
          }
        });
      }
      
      // Handle the chat form submission
      const chatForm = document.getElementById('chat-form');
      const chatInput = document.getElementById('chat-input');
      if (chatForm && chatInput) {
        chatForm.addEventListener('submit', function(e) {
          e.preventDefault();
          
          const userMessage = chatInput.value.trim();
          if (!userMessage) return;
          
          // Add user message to chat
          const chatMessages = document.getElementById('chat-messages');
          chatMessages.innerHTML += `
            <div class="flex items-start gap-3 max-w-[80%] ml-auto flex-row-reverse">
              <div class="w-8 h-8 rounded-full bg-accent flex items-center justify-center text-white shrink-0">
                <i class="ri-user-line text-sm"></i>
              </div>
              <div class="bg-accent/10 rounded-2xl rounded-tr-none p-4">
                <p class="text-black">${userMessage}</p>
              </div>
            </div>
          `;
          
          // Clear input
          chatInput.value = '';
          
          // Simulate AI typing with a delay
          setTimeout(() => {
            chatMessages.innerHTML += `
              <div class="flex items-start gap-3 max-w-[80%]">
                <div class="w-8 h-8 rounded-full bg-accent flex items-center justify-center text-white shrink-0">
                  <i class="ri-robot-line text-sm"></i>
                </div>
                <div class="bg-white rounded-2xl rounded-tl-none p-4 shadow-md">
                  <p class="text-black">To help you better, I need some information about your current plan. Could you please share your plan details?</p>
                  <button onclick="showPlanDetailsModal()" class="mt-4 w-full py-2 px-4 bg-accent/10 text-accent rounded-lg hover:bg-accent/20 transition-colors text-sm">
                    Share Plan Details
                  </button>
                </div>
              </div>
            `;
            
            // Scroll to the bottom of the chat
            chatMessages.scrollTop = chatMessages.scrollHeight;
          }, 1000);
          
          // Scroll to the bottom of the chat now
          chatMessages.scrollTop = chatMessages.scrollHeight;
        });
      }
    });
    
    // Function to display recommended plans in the chat
    function displayRecommendedPlans(plans, chatContainer, apiMessage) {
      // Create AI response with plan recommendations
      const aiResponse = document.createElement('div');
      aiResponse.className = 'flex items-start gap-3 max-w-[90%]';
      
      let messageText = apiMessage || "Based on your current plan details, here are my recommendations:";
      
      aiResponse.innerHTML = `
        <div class="w-8 h-8 rounded-full bg-accent flex items-center justify-center text-white shrink-0">
          <i class="ri-robot-line text-sm"></i>
        </div>
        <div class="bg-white rounded-2xl rounded-tl-none p-4 shadow-md">
          <p class="text-black mb-4">${messageText}</p>
          <div class="space-y-4 mt-4" id="plan-recommendations">
          </div>
        </div>
      `;
      
      chatContainer.appendChild(aiResponse);
      
      const recommendationsContainer = aiResponse.querySelector('#plan-recommendations');
      
      // Add each plan card
      if (plans && plans.length > 0) {
        plans.forEach(plan => {
          const planCard = document.createElement('div');
          planCard.className = 'bg-gray-50 rounded-xl p-4 border border-accent/10 hover:shadow-lg transition-shadow duration-300';
          
          // Format features if it's a string or an array
          let featuresHtml = '';
          if (Array.isArray(plan.features)) {
            featuresHtml = plan.features.map(feature => `<p>â€¢ ${feature}</p>`).join('');
          } else if (typeof plan.features === 'string') {
            featuresHtml = `<p>${plan.features}</p>`;
          } else if (plan.plan_features) {
            // Try to use plan_features if features is not available
            featuresHtml = `<p>${plan.plan_features}</p>`;
          }
          
          // Create the plan card content
          planCard.innerHTML = `
            <div class="flex justify-between items-center mb-2">
              <h4 class="font-display font-bold text-black">${plan.carrier} - ${plan.plan_name || 'Plan'}</h4>
              <span class="text-accent font-bold">$${plan.price}/mo</span>
            </div>
            <div class="text-sm text-gray-600">
              <p>Data: ${plan.data || '0'} GB</p>
              ${featuresHtml}
            </div>
            <button onclick="selectPlan('${plan.carrier}', ${plan.price}, '${plan.data || '0'}', '${plan.id || ''}', '${plan.plan_name || 'Plan'}')"
                    class="mt-3 w-full py-2 px-4 bg-accent text-white rounded-full hover:bg-accent/90 transition-all duration-300 transform hover:scale-[1.02] active:scale-[0.98]">
              Select Plan
            </button>
          `;
          
          recommendationsContainer.appendChild(planCard);
        });
      } else {
        // No plans found
        recommendationsContainer.innerHTML = `
          <div class="bg-gray-50 rounded-xl p-4 border border-accent/10">
            <p class="text-gray-600">I couldn't find any plans that match your criteria at this time. This could be because we don't have data for plans that would be better than your current one. You may want to try adjusting your requirements.</p>
            <button onclick="showPlanDetailsModal()" class="mt-3 w-full py-2 px-4 bg-accent text-white rounded-full hover:bg-accent/90 transition-all">
              Try Different Details
            </button>
          </div>
        `;
      }
      
      // Scroll to the bottom of the chat
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }
    
    // Function to display error messages in the chat
    function displayErrorMessage(chatContainer, message) {
      const errorMessage = document.createElement('div');
      errorMessage.className = 'flex items-start gap-3 max-w-[90%]';
      errorMessage.innerHTML = `
        <div class="w-8 h-8 rounded-full bg-accent flex items-center justify-center text-white shrink-0">
          <i class="ri-robot-line text-sm"></i>
        </div>
        <div class="bg-white rounded-2xl rounded-tl-none p-4 shadow-md">
          <p class="text-black">${message}</p>
          <button onclick="showPlanDetailsModal()" class="mt-3 w-full py-2 px-4 bg-accent text-white rounded-full hover:bg-accent/90 transition-all">
            Try Again
          </button>
        </div>
      `;
      
      chatContainer.appendChild(errorMessage);
      
      // Scroll to the bottom of the chat
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    function displayPlans(plans) {
      const container = document.getElementById('plans-container');
      container.innerHTML = '';
      
      // Update filtered plans
      filteredPlans = plans;
      
      if (plans.length === 0) {
        container.innerHTML = '<div class="no-plans-message">No plans found matching your requirements. Try adjusting your criteria.</div>';
        return;
      }

      // Create carousel wrapper and container
      const carouselWrapper = document.createElement('div');
      carouselWrapper.className = 'carousel-wrapper';
      
      const carouselContainer = document.createElement('div');
      carouselContainer.className = 'carousel-container';
      
      // Calculate slidesPerView based on screen width
      slidesPerView = getSlidesPerView();
      
      // Reset slide position
      currentSlide = 0;
      slideCount = Math.max(0, plans.length - slidesPerView);
      
      // Create plan cards
      plans.forEach(plan => {
        const card = createPlanCard(plan);
        carouselContainer.appendChild(card);
      });
      
      carouselWrapper.appendChild(carouselContainer);
      container.appendChild(carouselWrapper);
      
      // Add navigation buttons
      const navButtons = document.createElement('div');
      navButtons.className = 'carousel-nav';
      
      const prevButton = document.createElement('button');
      prevButton.id = 'carousel-prev';
      prevButton.innerHTML = '&lt;';
      prevButton.disabled = true;
      prevButton.addEventListener('click', () => {
        if (currentSlide > 0) {
          currentSlide--;
          updateCarousel();
        }
      });
      
      const nextButton = document.createElement('button');
      nextButton.id = 'carousel-next';
      nextButton.innerHTML = '&gt;';
      nextButton.disabled = plans.length <= slidesPerView;
      nextButton.addEventListener('click', () => {
        if (currentSlide < slideCount) {
          currentSlide++;
          updateCarousel();
        }
      });
      
      navButtons.appendChild(prevButton);
      navButtons.appendChild(nextButton);
      container.appendChild(navButtons);
      
      // Update buttons state
      updateNavButtons();
    }
</script>
</body>
</html>